# ë„ì»¤ ê°„ë‹¨íˆ ë”°ë¼í•˜ê¸°

## ì™œ Dockerë¥¼ ì‚¬ìš©í• ê¹Œ?

[ì™œ êµ³ì´ ë„ì»¤(ì»¨í…Œì´ë„ˆ)ë¥¼ ì¨ì•¼ í•˜ë‚˜ìš”? - ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ ](https://www.44bits.io/ko/post/why-should-i-use-docker-container)

â†’ ì„œë²„ í™˜ê²½ì„ gitì²˜ëŸ¼ ì½”ë“œ+ì‹œì ìœ¼ë¡œ ê´€ë¦¬í•¨ìœ¼ë¡œì¨, ë°”íƒ•í™˜ê²½ì— êµ¬ì• ë°›ì§€ ì•Šê³  ë™ì¼í•œ ì„œë²„í™˜ê²½ì„ ì–´ë””ì—ì„œë‚˜ êµ¬ì¶•í•  ìˆ˜ ìˆë‹¤.

ë„ì»¤ íŒŒì¼ == ì„œë²„ ìš´ì˜ ê¸°ë¡
ë„ì»¤ ì´ë¯¸ì§€ == ë„ì»¤ íŒŒì¼ + ì‹¤í–‰ ì‹œì 
ë„ì»¤ ì»¨í…Œì´ë„ˆ == ë„ì»¤ ì´ë¯¸ì§€ + í™˜ê²½ë³€ìˆ˜

ë„ì»¤ íŒŒì¼ì´ ì„œë²„ì˜ ìš´ì˜ ê³¼ì •ì„ ì­‰ ê¸°ë¡í•´ë†“ì€ í•˜ë‚˜ì˜ ì—­ì‚¬ì±…ì´ë¼ê³  í•œë‹¤ë©´, ë„ì»¤ ì´ë¯¸ì§€ëŠ” íŠ¹ì • ì‹œì ì˜ ì„œë²„ ëª¨ìŠµì„ í‹€(í´ë˜ìŠ¤)ì²˜ëŸ¼ ì£¼ì¡°í•œ ê²ƒì´ë¼ê³  í•  ìˆ˜ ìˆê³ , ì»¨í…Œì´ë„ˆëŠ” ì´ë¯¸ì§€ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì°ì–´ë‚¸ ì‹¤ì²´(ì¸ìŠ¤í„´ìŠ¤)ë¼ê³  í•  ìˆ˜ ìˆë‹¤.

ì´ì²˜ëŸ¼ ì„œë²„ ì½”ë“œí™”ë¥¼ í•¨ìœ¼ë¡œì¨ 

1. ì„œë²„ ì œì‘ê³¼ì •ì— ê²¬ê³ í•¨ê³¼ ìœ ì—°ì„±ì„ ë”í•˜ê³ 
2. ë‹¤ë¥¸ ì´ê°€ ë§Œë“  ì„œë²„ë¥¼ ì†Œí”„íŠ¸ì›¨ì–´ ì‚¬ìš©í•˜ë“¯ ê°–ë‹¤ì“¸ ìˆ˜ ìˆê³ 
3. ì—¬ëŸ¬ ëŒ€ì— ë°°í¬í•  ìˆ˜ ìˆëŠ” í™•ì¥ì„±ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.

- ì´ì™¸ì—ë„...

    ## ë„ì»¤ë¡œ ê°œë°œí™˜ê²½ì„ êµ¬ì„±í•´ì•¼í•˜ëŠ” ì´ìœ  - ì‚¬ë¡€ë¡œ ì„¤ëª…

    [ë„ì»¤(Docker) ì»´í¬ì¦ˆë¥¼ í™œìš©í•˜ì—¬ ì™„ë²½í•œ ê°œë°œ í™˜ê²½ êµ¬ì„±í•˜ê¸°](https://www.44bits.io/ko/post/almost-perfect-development-environment-with-docker-and-docker-compose#services)

    ## ë„ì»¤ì™€ VMì˜ ì°¨ì´

    [Dockerë€ ? VMê³¼ ì°¨ì´, Docker ì„¤ì¹˜ ë° ê¸°ë³¸ ëª…ë ¹ì–´ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ](https://corona-world.tistory.com/15)

---

### Docker ëª…ë ¹ì–´ í›‘ì–´ë³´ê¸°

[ğŸ³ Docker ë„ì»¤ - #1 ê¸°ë³¸ ëª…ë ¹ì–´ ëª¨ìŒ](https://velog.io/@wlsdud2194/-Docker-%EB%8F%84%EC%BB%A4-%EA%B8%B0%EB%B3%B8-%EB%AA%85%EB%A0%B9%EC%96%B4-%EB%AA%A8%EC%9D%8C)

[Docker ëª…ë ¹ì–´ ì •ë¦¬](https://iamreo.tistory.com/entry/Docker-%EB%AA%85%EB%A0%B9%EC%96%B4-%EC%A0%95%EB%A6%AC)

`docker <ëª…ë ¹>` í˜•ì‹ìœ¼ë¡œ ì´ë£¨ì–´ì§€ë©°, **í•­ìƒ rootê¶Œí•œ**ìœ¼ë¡œ ì‹¤í–‰í•´ì•¼í•œë‹¤.(root ì‚¬ìš©ìë¡œ ì ‘ê·¼í•˜ì§€ ì•Šì•˜ë‹¤ë©´ sudoë¥¼ ë¶™ì¼ê²ƒ)

---

# ë„ì»¤ ì‹¤ìŠµ(ì„œë²„ êµ¬ì¶•ë¶€í„° AWSê¹Œì§€)

## Searchë¡œ ë„ì»¤ í—ˆë¸Œì—ì„œ ì´ë¯¸ì§€ ê²€ìƒ‰í•˜ê¸°

í„°ë¯¸ë„(ì½˜ì†”)ì°½ì—ì„œ `docker search [OPTIONS] ê²€ìƒ‰í• ì´ë¯¸ì§€ëª…` ì„ ì‚¬ìš©í•´ ì›í•˜ëŠ” ì´ë¯¸ì§€ë¥¼ ë„ì»¤ í—ˆë¸Œì—ì„œ ê²€ìƒ‰í•  ìˆ˜ ìˆë‹¤.

ë„ì»¤ í—ˆë¸Œ :  ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë ˆí¬ì§€í† ë¦¬ì— ë“±ë¡í•˜ê³  ê³µìœ í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ë¡œ, ì½”ë“œë¥¼ ê³µìœ í•˜ëŠ” ê¹ƒí—ˆë¸Œì™€ ê°œë…ì ìœ¼ë¡œ ìœ ì‚¬í•˜ë‹¤.

`docker search ubuntu` ë¥¼ ê²€ìƒ‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ë„ì»¤í—ˆë¸Œì˜ ë§ì€ ì´ë¯¸ì§€ë“¤ì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ì¤‘ OFFICIAL [OK]ëŠ” ê³µì‹ ì´ë¯¸ì§€ì´ê³ , ë‚˜ë¨¸ì§€ëŠ” ì‚¬ìš©ìë“¤ì´ ë§Œë“  ì´ë¯¸ì§€ì´ë‹¤.

![img/_2020-05-30__11.57.06.png](img/_2020-05-30__11.57.06.png)

## pullë¡œ ì´ë¯¸ì§€ ë‹¤ìš´ë°›ê³  í™•ì¸í•˜ê¸°

`docker pull ubuntu:ë²„ì „` í˜¹ì€ `docker pull <ì‚¬ìš©ìì´ë¦„>/ubuntu` ë¥¼ ì´ìš©í•˜ì—¬ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ë¡œì»¬ë¡œ ë‚´ë ¤ë°›ëŠ”ë‹¤.

ìš°ë¦¬ëŠ” docker pull ubuntu:18.04ë¡œ **ubuntu 18.04ë²„ì „**ì„ ì‚¬ìš©í•  ê²ƒì´ë‹¤.

ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆë‹¤ë©´ `docker images` ëª…ë ¹ì–´ë¡œ ë¡œì»¬ì— ì¡´ì¬í•˜ëŠ” ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ëª¨ë‘ ë³¼ ìˆ˜ ìˆë‹¤.

![img/_2020-05-30__12.05.06.png](img/_2020-05-30__12.05.06.png)

`docker rmi <ì´ë¯¸ì§€ëª…>:<íƒœê·¸>`ì„ ì‚¬ìš©í•´ì„œ ì‚¬ìš©í•˜ì§€ ì•Šì„ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆë‹¤.

*(docker rmi ubuntu 18.04)*

## Container ì‚¬ìš©í•˜ê¸°

- Container ëª…ë ¹ì–´ ì •ë¦¬
    - ì»¨í…Œì´ë„ˆ ìƒì„±
        - `docker create [OPTIONS] IMAGE [COMMAND] [ARG...]`  : ì´ë¯¸ì§€ë¡œ ì»¨í…Œì´ë„ˆë¥¼ **ìƒì„±ë§Œ** í•œë‹¤.
        - `docker run [OPTIONS] IMAGE [COMMAND] [ARG...]` : ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•´ì„œ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ê³  **ë°”ë¡œ ì‹¤í–‰ê¹Œì§€ í•œë‹¤**.
    - ì»¨í…Œì´ë„ˆ ì‹¤í–‰
        - `docker start [OPTIONS] CONTAINER [CONTAINER...]` : ì¤‘ì§€ ìƒíƒœì˜ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
        - `docker restart [OPTIONS] CONTAINER [CONTAINER...]` : ì‹¤í–‰ ì¤‘ì¸ ìƒíƒœì˜ ì»¨í…Œì´ë„ˆ ì¬ì‹¤í–‰(ì¬ë¶€íŒ… ê°œë…)
    - ì»¨í…Œì´ë„ˆ ì¤‘ì§€
        - `docker stop [OPTIONS] CONTAINER [CONTAINER...]` : ì‹¤í–‰ ìƒíƒœì˜ ì»¨í…Œì´ë„ˆ ì¤‘ì§€
    - ì»¨í…Œì´ë„ˆ ì‚­ì œ
        - `docker rm [OPTIONS] CONTAINER [CONTAINER...]`  : ì»¨í…Œì´ë„ˆ ì‚­ì œ

`docker run -it --name "test" ubuntu:18.04 /bin/bash` ëª…ë ¹ì–´ë¡œ ubuntu 18.04 ì´ë¯¸ì§€ë¥¼ ì´ìš©í•œ ë„ì»¤ì»¨í…Œì´ë„ˆ testë¥¼ ë§Œë“¤ì–´ë³¸ë‹¤.

- ëª…ë ¹ì–´ í•´ì„
    - -it : í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ í„°ë¯¸ë„ì— ê²°ê³¼ ì¶œë ¥ (-iì™€ -t ë”°ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ)
    - â€”rm : ì‹¤í–‰ í›„ ì»¨í…Œì´ë„ˆ ë°”ë¡œ ì‚­ì œ
    - â€”name <ì»¨í…Œì´ë„ˆ ì´ë¦„> : ì»¨í…Œì´ë„ˆ ì´ë¦„ ì§€ì •
    - ubuntu:18.04 : ì‚¬ìš©í•  ì´ë¯¸ì§€ ì´ë¦„ ì„ íƒ
    - /bin/bash : ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì ‘ì† í›„ ì‹¤í–‰í•˜ëŠ” ì»¤ë§¨ë“œ (ì ‘ì†í•˜ìë§ˆì ë°”ë¡œ í„°ë¯¸ë„ ì¼œê¸°)

![img/_2020-05-30__12.20.55.png](img/_2020-05-30__12.20.55.png)

ì™„ë£Œì‹œ ìœ„ì™€ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¨ë‹¤.

ì´í›„ terminalê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ë‘˜ëŸ¬ë³¼ ìˆ˜ ìˆë‹¤.

ë‚˜ê°€ëŠ” ë°©ë²•ì€ `exit` . exití•˜ë©´ **ìë™ìœ¼ë¡œ ì»¨í…Œì´ë„ˆê°€** **ì¤‘ì§€**ëœë‹¤. (= `ctrl` + `d`)

ì»¨í…Œì´ë„ˆë¥¼ **ì¤‘ì§€í•˜ì§€ ì•Šê³ ** ë¹ ì ¸ë‚˜ì˜¤ë ¤ë©´ `ctrl` + `p` + `q`ì…ë ¥. 

ì‹¤í–‰ë˜ê³  ìˆëŠ” ë„ì»¤ ì»¨í…Œì´ë„ˆëŠ” `docker ps` ë¥¼ í†µí•´ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![img/_2020-05-30__12.27.58.png](img/_2020-05-30__12.27.58.png)

ì¤‘ì§€ëœ ì»¨í…Œì´ë„ˆê¹Œì§€ ëª¨ë‘ ë³´ë ¤ë©´ `docker ps -al` ì„ ì‚¬ìš©í•œë‹¤.

![img/_2020-05-30__12.28.26.png](img/_2020-05-30__12.28.26.png)

ì¤‘ì§€ëœ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ `docker start <ì»¨í…Œì´ë„ˆëª…>` ì„ ì‚¬ìš©í•œë‹¤.

**startëŠ” ì‹¤í–‰ ëª…ë ¹ì–´**ì´ì§€, ****ì ‘ì† ëª…ë ¹ì–´ê°€ **ì•„ë‹ˆë‹¤**. ë”°ë¼ì„œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œì¼œ ë†“ê³  ë‹¤ì‹œ root í„°ë¯¸ë„ë¡œ ëŒì•„ì˜¨ë‹¤.

ë§Œì•½ ì»¨í…Œì´ë„ˆì— ë‹¤ì‹œ ì ‘ì†í•˜ê³  ì‹¶ë‹¤ë©´ `docker attach <ì»¨í…Œì´ë„ˆëª…>`ì„ ì‚¬ìš©í•œë‹¤.

![img/_2020-05-30__12.32.27.png](img/_2020-05-30__12.32.27.png)

ì»¨í…Œì´ë„ˆì— ì ‘ì†í•˜ì§€ ì•Šì€ ìƒíƒœë¡œë„ `docker exac <ì»¨í…Œì´ë„ˆëª…> <ëª…ë ¹> <ë§¤ê°œë³€ìˆ˜>` ë¡œ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. apt-getì´ë‚˜ yumì„ ì´ìš©í•´ íŒ¨í‚¤ì§€ë‚˜ ê°ì¢… ë°ëª¬ì„ ì‹¤í–‰í•  ë•Œ ì‚¬ìš©ëœë‹¤.

`docker rm <ì»¨í…Œì´ë„ˆëª…>` ì„ ì‚¬ìš©í•´ì„œ ì‚¬ìš©í•˜ì§€ ì•Šì„ ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œí•  ìˆ˜ ìˆë‹¤.

![img/_2020-05-30__12.34.04.png](img/_2020-05-30__12.34.04.png)

ì´í›„ í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ë˜ì—ˆë˜ ubuntu:18.04 ì´ë¯¸ì§€ íŒŒì¼ì„ ì‚­ì œí•´ë„ ëœë‹¤.

`docker rmi ubuntu:18.04`

## Node.js ìƒ˜í”Œ í”„ë¡œì íŠ¸ ìƒì„±í•˜ê¸°

í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•  í´ë”ë¡œ ì´ë™í•˜ì—¬ express í´ë”ë¥¼ ìƒì„±í•œë‹¤. **expressê°€ ê¹”ë ¤ìˆë‹¤ëŠ” ì „ì œí•˜**ì— ì‘ë™í•œë‹¤.

```bash
#expressë¡œ í”„ë¡œì íŠ¸ ìƒì„±
express sample-project

#sample-projectë¡œ ì´ë™
cd sample-project

#dependencies ì„¤ì¹˜
npm install

#ì„œë²„ê°€ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸
npm start
```

![img/_2020-05-30__12.42.10.png](img/_2020-05-30__12.42.10.png)

ìœ„ì™€ê°™ì´ 3000ë²ˆ í¬íŠ¸ì— Welcome to Expressê°€ ëœ¨ë©´ ì„±ê³µì´ë‹¤.

### Docker file ì‘ì„±

Docker fileì´ë€?  :  ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ë‚´ê¸° ìœ„í•´ DSLDomain-specific languageë¼ëŠ” ìì²´ ì–¸ì–´ë¥¼ ì´ìš©í•˜ì—¬ ìƒì„±ê³¼ì •ì„ ì ì–´ë‘ëŠ”ê²ƒ. Djangoì—ì„œ Django í™˜ê²½ì„ ì¼ê´€ì„±ìˆê²Œ ìœ ì§€í•˜ê¸° ìœ„í•´ ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ì„¤ì •íŒŒì¼ requirement.txtë¥¼ ê¸°ë¡í•´ë‘ì—ˆëŠ”ë°, Docker Imageë„ ì´ì²˜ëŸ¼ Dockerfileì´ë¼ëŠ” ì„¤ê³„ë„ë¥¼ í†µí•˜ì—¬ êµ¬ì„±ëœë‹¤.

Sample-projectì— ë“¤ì–´ê°€ Dockerfileê³¼ .dockerignoreì„ ë§Œë“¤ì–´ì¤€ë‹¤.

Docker fileì€ ì–´ë–¤ ì´ë¯¸ì§€ë¥¼ ë² ì´ìŠ¤ë¡œ ë§Œë“¤ì–´ì§ˆ ê²ƒì¸ì§€ ê²°ì •í•œë‹¤.

.dockerignoreì€ ìš°ë¦¬ê°€ ìµíˆ ì•Œê³ ìˆëŠ” .gitignoreê³¼ ìœ ì‚¬í•œ ë°©ì‹ìœ¼ë¡œ ë™ì‘í•œë‹¤. ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ ë•Œ êµ³ì´ í¬í•¨ë˜ì§€ ì•Šì•„ë„ ë˜ëŠ” í´ë”/íŒŒì¼ ë“±ì„ ì œì™¸ì‹œí‚¬ë•Œ ì‚¬ìš©í•œë‹¤.

ë„ì»¤ ì´ë¯¸ì§€ íŒŒì¼ì— node_modules í´ë”ê°€ ë“¤ì–´ê°€ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•´ .dockerignore íŒŒì¼ì„ ì„¤ì •í•´ì¤€ë‹¤.

```docker
# .dockerignore

node_modules/
```

ì´í›„ Dockerfileì„ ì„¤ì •í•œë‹¤. 

```docker
# Dockerfile

# Docker Hub ë‚´ì—ì„œ nodeì˜ LTS ë²„ì „ì¸ 12ë²„ì „ì„ ë² ì´ìŠ¤ ì´ë¯¸ì§€ë¡œ í•œë‹¤
FROM node:12

# ë„ì»¤ íŒŒì¼ ìƒì„±/ê´€ë¦¬ì ì •ë³´ë¥¼ ê¸°ë¡í•œë‹¤
MAINTAINER ìƒì„±ìëª… <ì´ë©”ì¼ ì£¼ì†Œ>

# CMDì—ì„œ ì„¤ì •í•œ ì‹¤í–‰ íŒŒì¼ì´ ì‹¤í–‰ë  ë””ë ‰í„°ë¦¬ë¥¼ ì§€ì •í•œë‹¤
WORKDIR /usr/src/app

# ë² ì´ìŠ¤ì´ë¯¸ì§€ì— Node.jsì™€ npmì´ ìˆìœ¼ë¯€ë¡œ ì•±ì˜ dependanciesë§Œ ì„¤ì¹˜í•´ì¤€ë‹¤
# npm ë²„ì „ì´ 4 ì´ìƒì´ë¼ë©´ package.jsonê³¼ package-lock.jsonì„ ëª¨ë‘ ìƒì„±í•´ì£¼ëŠ” ì½”ë“œì´ë‹¤
COPY package*.json ./

RUN npm install

# ì•±ì˜ ì†ŒìŠ¤íŒŒì¼ì„ ì¶”ê°€í•œë‹¤
COPY . .

# ê°€ìƒë¨¸ì‹ ì— ì˜¤í”ˆí•  í¬íŠ¸ë²ˆí˜¸ë¥¼ ë„ì»¤ ë°ëª¬ì— ë§¤í•‘í•œë‹¤
# ë„ì»¤ë°ëª¬ : docker API ìš”ì²­ì„ ìˆ˜ì‹ í•˜ê³  ì´ë¯¸ì§€, ì»¨í…Œì´ë„ˆ, ë„¤íŠ¸ì›Œí¬ ë° ë³¼ë¥¨ê°™ì€ ë„ì»¤ ê°ì²´ë¥¼ ê´€ë¦¬í•œë‹¤
EXPOSE 3000

# ëŸ°íƒ€ì„ì„ ì •ì˜í•˜ëŠ” ì»¤ë§¨ë“œë¡œ ì•±ì„ ì‹¤í–‰í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì‘ì„±í•œë‹¤.
CMD ["npm", "start"]
```

ìœ„ì˜ íŒŒì¼ì„ ëª¨ë‘ ì‘ì„±í–ˆìœ¼ë©´ ë‹¤ì‹œ terminalë¡œ ëŒì•„ê°€ Dockerfileì´ ìˆëŠ” ë””ë ‰í„°ë¦¬ë¡œ ì´ë™í•œ í›„, ë„ì»¤ íŒŒì¼ì„ ì´ìš©í•´ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•œë‹¤.

`docker build --tag <ì‚¬ìš©ì ëª…>/<ë ˆí¬ì§€í† ë¦¬ ëª…>:<íƒœê·¸ëª…> .` ëª…ë ¹ì–´ë¥¼ ì´ìš©í•˜ì—¬ ì´ë¯¸ì§€ì— íƒœê·¸ëª…ì„ ë¶™ì¸ ìƒíƒœë¡œ ë¹Œë“œí•œë‹¤.

docker imagesë¡œ ë¡œì»¬ì˜ ì´ë¯¸ì§€ë¥¼ í™•ì¸í•˜ë©´, `seongik/sample` ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ë¨¼ì € `node:12` ì´ë¯¸ì§€ê°€ ì„¤ì¹˜ë˜ì—ˆê³ , ê·¸ ì´í›„ ì„¤ì •í•´ë‘” ë„ì»¤íŒŒì¼ì— ì˜í•´ ì´ë¯¸ì§€ê°€ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

```powershell
$ docker build --tag seongik/sample:node . 
Sending build context to Docker daemon  46.08kB
Step 1/8 : FROM node:12
 ---> a37df1a0b8f0
Step 2/8 : MAINTAINER <ì‚¬ìš©ì ëª…> <ì´ë©”ì¼ ëª…>
 ---> Running in 57c5b71979fb
Removing intermediate container 57c5b71979fb
 ---> 0c7a316c9795
Step 3/8 : WORKDIR /usr/src/app
 ---> Running in e7725e2f78cf
Removing intermediate container e7725e2f78cf
 ---> 4b29c8d39fc1
Step 4/8 : COPY package*.json ./
 ---> 2720ccae1e5d
Step 5/8 : RUN npm install
 ---> Running in 5b8f8ff5cd8e
added 100 packages from 139 contributors and audited 101 packages in 2.163s
found 4 vulnerabilities (3 low, 1 critical)
  run `npm audit fix` to fix them, or `npm audit` for details
Removing intermediate container 5b8f8ff5cd8e
 ---> 00d6d7027454
Step 6/8 : COPY . .
 ---> b73d028aa180
Step 7/8 : EXPOSE 3000
 ---> Running in 3eb1dc9189e4
Removing intermediate container 3eb1dc9189e4
 ---> b25319378f74
Step 8/8 : CMD ["npm", "start"]
 ---> Running in 966e67aa5e9b
Removing intermediate container 966e67aa5e9b
 ---> e7588bda218b
Successfully built e7588bda218b
Successfully tagged seongik/sample:node
```

![img/_2020-05-30__1.27.42.png](img/_2020-05-30__1.27.42.png)

ì´ì œ ë§Œë“¤ì–´ì§„ ì´ë¯¸ì§€ë¥¼ ì´ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ë¹Œë“œí•´ë³´ì. ì´ë²ˆì—ëŠ” ì»¨í…Œì´ë„ˆì— ì ‘ì†í•˜ì§€ ì•Šì€ì±„ë¡œ ì»¨í…Œì´ë„ˆê°€ ì„œë²„ë¥¼ ìˆ˜í–‰í•˜ë„ë¡ ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰í•´ë†“ê³ , í˜¸ìŠ¤íŠ¸ì˜ í¬íŠ¸ì—ì„œ í•´ë‹¹ ë¡œì»¬ í¬íŠ¸ì— ì ‘ì†í•´ ë³¼ê²ƒì´ë‹¤.

`docker run -d -p <í˜¸ìŠ¤íŠ¸ì—ì„œ ì ‘ì†í•  í¬íŠ¸>:<ì»¨í…Œì´ë„ˆì—ì„œ ìˆ˜í–‰í•˜ëŠ” í¬íŠ¸> <username>/<ì´ë¯¸ì§€ ëª…>:<íƒœê·¸ëª…>`

- run ëª…ë ¹ì–´ ì˜µì…˜ í•´ì„

    -d : (detached), í•´ë‹¹ ì»¨í…Œì´ë„ˆë¥¼ ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰ì‹œí‚¨ë‹¤(ì ‘ì†í•˜ì§€ ì•Šê³  ì‹¤í–‰ì‹œí‚¨ë‹¤)

    -p : ì»¨í…Œì´ë„ˆì˜ í¬íŠ¸ì™€ í˜¸ìŠ¤íŠ¸ì˜ í¬íŠ¸ë¥¼ ì—°ê²°ì‹œì¼œì¤€ë‹¤. ìˆœì„œëŠ” <í˜¸ìŠ¤íŠ¸ í¬íŠ¸>:<ì»¨í…Œì´ë„ˆí¬íŠ¸> ìˆœì´ë‹¤.

- ì ê¹ë§Œ! runì´ ì•ˆëœë‹¤ë©´?

    [ê°œë°œìê°€ ì²˜ìŒ Docker ì ‘í• ë•Œ ì˜¤ëŠ” ë©˜ë¶• ëª‡ê°€ì§€ | Popit](https://www.popit.kr/%EA%B0%9C%EB%B0%9C%EC%9E%90%EA%B0%80-%EC%B2%98%EC%9D%8C-docker-%EC%A0%91%ED%95%A0%EB%95%8C-%EC%98%A4%EB%8A%94-%EB%A9%98%EB%B6%95-%EB%AA%87%EA%B0%80%EC%A7%80/)

    [[Docker Study] 3. ë„ì»¤ì˜ ëª‡ ëª‡ run ì˜µì…˜ë“¤](https://m.blog.naver.com/alice_k106/220340499760)

docker run -d -p 8080:3000 <ì‚¬ìš©ìëª…>/<ì´ë¯¸ì§€ ëª…>:<íƒœê·¸ëª…> ìœ¼ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œì¼°ë‹¤ë©´, ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì˜ express serverê°€ npm startë¡œ ì‹œì‘ë˜ì–´ 3000í¬íŠ¸ì— ì„œë²„ë¡œì„œ ë™ì‘í•˜ê³ ìˆê³ , í•´ë‹¹ 3000í¬íŠ¸ê°€ í˜¸ìŠ¤íŠ¸ì˜ 8080í¬íŠ¸ì™€ ì—°ê²°ë˜ì–´ìˆìœ¼ë¯€ë¡œ, [localhost:8080](http://localhost:8080) í¬íŠ¸ì—ì„œ Express ì„œë²„ì˜ ë™ì‘ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![img/_2020-05-30__1.26.47.png](img/_2020-05-30__1.26.47.png)

ì´í›„ `Docker logs --follow <ì»¨í…Œì´ë„ˆ ID>` ë¡œ í•´ë‹¹ ì»¨í…Œì´ë„ˆì˜ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì•„ê¹Œ ì‹¤í–‰ì‹œì¼œë‘” ë…¸ë“œ ì»¨í…Œì´ë„ˆëŠ” ì„œë²„ì—­í• ì„ í•˜ê³  ìˆìœ¼ë¯€ë¡œ ì ‘ì†ì‹œì˜ ë¡œê·¸ê°€ ì°í˜€ë‚˜ì˜¤ëŠ”ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

![img/_2020-05-30__1.35.21.png](img/_2020-05-30__1.35.21.png)

## ìƒì„±í•œ ì´ë¯¸ì§€ AWSì— ë°°í¬í•˜ê¸°

ì´ì „ê¹Œì§€ëŠ” í˜¸ìŠ¤íŠ¸ì™€ ì»¨í…Œì´ë„ˆ ëª¨ë‘ ë¡œì»¬ í¬íŠ¸ë¥¼ ì´ìš©í–ˆê¸° ë•Œë¬¸ì— ë¡œì»¬ì—ì„œ ì»¨í…Œì´ë„ˆì— ì ‘ê·¼í•  ìˆ˜ ìˆì—ˆì§€ë§Œ, ì‹¤ì œë¡œ AWSì— ë°°í¬í•˜ëŠ” ê²ƒì€ ì–´ë””ì—ì„œë‚˜ ì›¹ì„ í†µí•˜ì—¬ ì ‘ê·¼í•˜ì—¬ ëˆ„êµ¬ì—ê²Œë‚˜ ë™ì¼í•œ í™˜ê²½ì„ ì œê³µí•˜ëŠ”ê²ƒì´ë‹¤. ë”°ë¼ì„œ ë…¸ë“œ ì„œë²„ í”„ë¡œì„¸ìŠ¤ê´€ë¦¬ìì¸ **pm2**ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.

pm2ë€? :  ë…¸ë“œ ì „ìš© í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ìë¡œ, ì„œë²„ ì—ëŸ¬ë‚˜ ë¡œê·¸, ìë™ ì‹¤í–‰ë“±ì˜ ë§ì€ í•¸ë“¤ë§ì„ ê°„í¸í™” ì‹œì¼œì£¼ëŠ” ëª¨ë“ˆì´ë‹¤.

- pm2ì— ê´€í•´ì„œëŠ” ì´ê²ƒì„ ì°¸ì¡°í•˜ì

    [ë…¸ë“œë¥¼ ë” ìš°ì•„í•˜ê²Œ. pm2 ì´ì•¼ê¸°](https://jybaek.tistory.com/716)

    [pm2ì— ëŒ€í•´ ì•Œì•„ë³´ì](https://ocsusu.tistory.com/26)

    [PM2ë¥¼ í™œìš©í•œ Node.js ë¬´ì¤‘ë‹¨ ì„œë¹„ìŠ¤í•˜ê¸° - LINE ENGINEERING](https://engineering.linecorp.com/ko/blog/pm2-nodejs/)

ì´ì „ì— ë§Œë“¤ì—ˆë˜ ë„ì»¤ ì»¨í…Œì´ë„ˆì™€ ë¹Œë“œí•œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ëª¨ë‘ ì‚­ì œí•œë‹¤.

ì´í›„ Dockerfileì„ ìˆ˜ì •í•´ì¤€ë‹¤.

```docker
# Dockerfile

FROM node:12

MAINTAINER SeongIk Kim <kpic1638@gmail.com>

WORKDIR /usr/src/app

COPY package*.json ./

RUN npm install

# ì¶”ê°€ëœ ë¶€ë¶„ : pm2 ì„¤ì¹˜
RUN npm install -g pm2

COPY . .

EXPOSE 3000

# ì¶”ê°€ëœ ë¶€ë¶„ : pm2ë¡œ runí•˜ê¸°
CMD ["pm2-runtime","start", "./bin/www"]
```

ì´í›„ ì´ë¯¸ì§€ë¥¼ ë‹¤ì‹œ ìƒˆë¡œ ë¹Œë“œí•œë‹¤.

### Docker hubì— ë‚´ ì´ë¯¸ì§€ Pushí•˜ê¸°

`sudo docker login`ì„ í†µí•´ í„°ë¯¸ë„ì—ì„œ ë„ì»¤ë¥¼ ë¡œê·¸ì¸í•´ì¤€ë‹¤.(ì²« ë¹„ë°€ë²ˆí˜¸ëŠ” í˜¸ìŠ¤íŠ¸ ì»´í“¨í„° ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸ì´ê³ , ë‘ë²ˆì§¸ ë¹„ë°€ë²ˆí˜¸ëŠ” docker hub ì›¹ì‚¬ì´íŠ¸ ë¹„ë°€ë²ˆí˜¸ì´ë‹¤.)

```bash
$ sudo docker login
Password:
Authenticating with existing credentials...
Stored credentials invalid or expired
Login with your Docker ID to push and pull images from Docker Hub. If you don't have a Docker ID, head over to https://hub.docker.com to create one.
Username (kpic5014): 
Password: 
Login Succeeded
```

ì´í›„ `docker push <ì‚¬ìš©ì ëª…>/<ë ˆí¬ì§€í† ë¦¬ ëª…>:<íƒœê·¸ ëª…>` ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ docker hubì— ë‚´ ì´ë¯¸ì§€ë¥¼ í‘¸ì‹œí•œë‹¤.

- denied: requested access to the resource is denied ì—ëŸ¬ê°€ ëœ¬ë‹¤ë©´?

    [[Docker CE] ë„ì»¤ ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¶Œí•œ ì—ëŸ¬ (denied: requested access to the resource is denied)](https://nirsa.tistory.com/53)

    í•´ë‹¹ ë§í¬ë¥¼ ì°¸ì¡°í•˜ì. ì‚¬ìš©ìëª…ê³¼ docker hub ë„¤ì„ì´ ë§ì§€ ì•Šì•„ì„œ ìƒê¸°ëŠ” ë¬¸ì œì¼ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤.

ì´í›„ AWS EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•œë‹¤.

- ë§Œì•½ ì¸ìŠ¤í„´ìŠ¤ê°€ ì—†ë‹¤ë©´ ì´ ë§í¬ë¥¼ ì°¸ê³ í•˜ì—¬ ë§Œë“¤ì–´ë³´ì.

    [[AWS] EC2 ì„œë²„ ì‚¬ìš©í•˜ê¸°](https://ooeunz.tistory.com/35)

EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í–ˆë‹¤ë©´,  ì•„ë˜ì˜ ëª…ë ¹ì–´ë“¤ì„ ì…ë ¥í•´ë³´ì.

```bash
curl -fsSL https://get.docker.com/ | sudo sh
sudo usermod -aG docker $USER

sudo curl -L "https://github.com/docker/compose/releases/download/1.24.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# check (re-login)
docker version
docker-compose version

# reboot
sudo reboot
```

ìë™ìœ¼ë¡œ ë„ì»¤ë¥¼ ì„¤ì¹˜í•˜ê³ , rebootí•˜ëŠ” ëª…ë ¹ì–´ì´ë‹¤.

```bash
ubuntu@ip-172-31-32-165:~$ curl -fsSL https://get.docker.com/ | sudo sh
# Executing docker install script, commit: 26ff363bcf3b3f5a00498ac43694bf1c7d9ce16c
+ sh -c apt-get update -qq >/dev/null
+ sh -c DEBIAN_FRONTEND=noninteractive apt-get install -y -qq apt-transport-https ca-certificates curl >/dev/null
+ sh -c curl -fsSL "https://download.docker.com/linux/ubuntu/gpg" | apt-key add -qq - >/dev/null
+ sh -c echo "deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable" > /etc/apt/sources.list.d/docker.list
+ sh -c apt-get update -qq >/dev/null
+ [ -n  ]
+ sh -c apt-get install -y -qq --no-install-recommends docker-ce >/dev/null
+ sh -c docker version
Client: Docker Engine - Community
 Version:           19.03.10
 API version:       1.40
 Go version:        go1.13.10
 Git commit:        9424aeaee9
 Built:             Thu May 28 22:17:05 2020
 OS/Arch:           linux/amd64
 Experimental:      false

Server: Docker Engine - Community
 Engine:
  Version:          19.03.10
  API version:      1.40 (minimum version 1.12)
  Go version:       go1.13.10
  Git commit:       9424aeaee9
  Built:            Thu May 28 22:15:37 2020
  OS/Arch:          linux/amd64
  Experimental:     false
 containerd:
  Version:          1.2.13
  GitCommit:        7ad184331fa3e55e52b890ea95e65ba581ae3429
 runc:
  Version:          1.0.0-rc10
  GitCommit:        dc9208a3303feef5b3839f4323d9beb36df0a9dd
 docker-init:
  Version:          0.18.0
  GitCommit:        fec3683
If you would like to use Docker as a non-root user, you should now consider
adding your user to the "docker" group with something like:

  sudo usermod -aG docker your-user

Remember that you will have to log out and back in for this to take effect!

WARNING: Adding a user to the "docker" group will grant the ability to run
         containers which can be used to obtain root privileges on the
         docker host.
         Refer to https://docs.docker.com/engine/security/security/#docker-daemon-attack-surface
         for more information.
ubuntu@ip-172-31-32-165:~$ sudo usermod -aG docker $USER
ubuntu@ip-172-31-32-165:~$ sudo curl -L "https://github.com/docker/compose/releases/download/1.24.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   638  100   638    0     0   1468      0 --:--:-- --:--:-- --:--:--  1470
100 15.4M  100 15.4M    0     0  3318k      0  0:00:04  0:00:04 --:--:-- 4512k
ubuntu@ip-172-31-32-165:~$ sudo chmod +x /usr/local/bin/docker-compose
ubuntu@ip-172-31-32-165:~$ docker version
Client: Docker Engine - Community
 Version:           19.03.10
 API version:       1.40
 Go version:        go1.13.10
 Git commit:        9424aeaee9
 Built:             Thu May 28 22:17:05 2020
 OS/Arch:           linux/amd64
 Experimental:      false
Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.40/version: dial unix /var/run/docker.sock: connect: permission denied

ubuntu@ip-172-31-32-165:~$ docker-compose version
docker-compose version 1.24.0, build 0aa59064
docker-py version: 3.7.2
CPython version: 3.6.8
OpenSSL version: OpenSSL 1.1.0j  20 Nov 2018
```

ìœ„ì™€ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¤ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

`sudo systemctl status docker` ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ ë„ì»¤ê°€ ì œëŒ€ë¡œ ì„¤ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![img/_2020-05-30__5.06.44.png](img/_2020-05-30__5.06.44.png)

ë„ì»¤ê°€ ì œëŒ€ë¡œ ì„¤ì¹˜ë˜ì—ˆë‹¤ë©´ ì´ì œ Docker Hubì— Pushí•´ë‘ì—ˆë˜ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë‚´ë ¤ë°›ì„ ì‹œê°„ì´ë‹¤.

ì§€ê¸ˆì€ EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ssh ì„œë²„ì— ì ‘ì†í•´ìˆìœ¼ë¯€ë¡œ, sshì„œë²„ì—ì„œ `sudo docker login` ì„ í†µí•´ docker ê³„ì •ì— ì ‘ì†í•œë‹¤.

ì´í›„ `docker pull <ì‚¬ìš©ì ëª…>/<ë ˆí¬ì§€í† ë¦¬ ëª…>:<íƒœê·¸ëª…>` ìœ¼ë¡œ docker hubì— ì˜¬ë ¤ì§„ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë°›ëŠ”ë‹¤.

```bash
ubuntu@ip-172-31-32-165:~$ sudo docker pull kpic5014/sample:node
node: Pulling from kpic5014/sample
1c6172af85ee: Pull complete 
b194b0e3c928: Pull complete 
1f5ec00f35d5: Pull complete 
93b1353672b6: Pull complete 
3d7f38db3cca: Pull complete 
21e102f9fe89: Pull complete 
42367c0e61d0: Pull complete 
647509a3a3f6: Pull complete 
0d4135ddc440: Pull complete 
a6ed72cd3d79: Pull complete 
abec976f329a: Pull complete 
40faa714ac6b: Pull complete 
85bbb3035b0c: Pull complete 
455f47466c8d: Pull complete 
Digest: sha256:69ea37b77d18a886faf84dc462d8468ec5622bf8d100034823b9b61982f80599
Status: Downloaded newer image for kpic5014/sample:node
docker.io/kpic5014/sample:node
```

ì´ì œ ë°›ì•„ì§„ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ í† ëŒ€ë¡œ docker containerë¥¼ runí•´ì£¼ë©´, ë¡œì»¬ì—ì„œ ë§Œë“¤ì–´ë‘ì—ˆë˜ express ì„œë²„ê°€ ê·¸ëŒ€ë¡œ AWS ì¸ìŠ¤í„´ìŠ¤ì—ì„œë„ ì ìš©ëœë‹¤.

`docker run -t -i -p <í¬ì›Œë”©í•  í¬íŠ¸(ì›¹ì— ì˜¬ë¼ê°ˆ í¬íŠ¸)>:<ssh ì»¨í…Œì´ë„ˆ í¬íŠ¸> <ì‚¬ìš©ìëª…>/<ë ˆí¬ì§€í† ë¦¬ëª…>:<íƒœê·¸ëª…>`

- ì ê¹! run ì˜µì…˜ì´ ì˜ ê¸°ì–µì´ ì•ˆë‚œë‹¤ë©´..

    -t + -i :(tty, interactive) -itë¡œë„ ì“¸ ìˆ˜ ìˆìœ¼ë©°, ì´ ì˜µì…˜ì„ ì¤˜ì•¼ ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ í„°ë¯¸ë„ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.

    -p [í˜¸ìŠ¤íŠ¸ í¬íŠ¸: ì»¨í…Œì´ë„ˆ í¬íŠ¸] : ì»¨í…Œì´ë„ˆì˜ í¬íŠ¸ì™€ í˜¸ìŠ¤íŠ¸ì˜ í¬íŠ¸ë¥¼ ì—°ê²°ì‹œì¼œì¤€ë‹¤.

![img/_2020-05-30__5.26.16.png](img/_2020-05-30__5.26.16.png)

`í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ IPì£¼ì†Œ(íƒ„ë ¥ì  IP):í¬íŠ¸ë²ˆí˜¸` ë¡œ ì ‘ì†í•˜ë©´ AWS ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë°°í¬í•œ ê°„ë‹¨í•œ Express ì„œë²„ë¥¼ ì „ ì„¸ê³„ ì–´ëŠê³³ì—ì„œë‚˜ ì ‘ì†í•  ìˆ˜ ìˆë‹¤.

```bash
ubuntu@ip-172-31-32-165:~$ sudo docker run -t -i -p 3000:3000 kpic5014/sample:node
2020-05-30T08:18:59: PM2 log: Launching in no daemon mode
2020-05-30T08:18:59: PM2 log: App [www:0] starting in -fork mode-
2020-05-30T08:18:59: PM2 log: App [www:0] online
GET / 200 206.113 ms - 170
GET /stylesheets/style.css 200 3.046 ms - 111
GET /favicon.ico 404 14.930 ms - 942
```

í•´ë‹¹ ì ‘ì† ê¸°ë¡ì´ ì„œë²„ë¥¼ ìˆ˜í–‰í•˜ê³ ìˆëŠ” ssh ì»¨í…Œì´ë„ˆì— ê¸°ë¡ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

ì´ë¡œì„œ Dockerë¥¼ ì´ìš©í•œ ê°„ë‹¨í•œ Express ì„œë²„ ë°°í¬ë!

---

ë©”ì¸ ë ˆí¼ëŸ°ìŠ¤ëŠ” ì•„ë˜ ì£¼ì†Œë¥¼ ì°¸ì¡°í–ˆìœ¼ë©°, ì´ ë¬¸ì„œëŠ” ì•„ë˜ ë¬¸ì„œë¥¼ ê±°ì˜ ì˜®ê²¨ë†“ì€ ìˆ˜ì¤€ì…ë‹ˆë‹¤. ë¬¸ì œê°€ ìˆë‹¤ë©´ ê¼­ ì´ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”!

[[Docker] Docker Tutorial (1) : ê¸°ë³¸ì ì¸ ì‚¬ìš©ë²•](https://ooeunz.tistory.com/68?category=821628)