본 글은 켄트 백의 <테스트 주도 개발>을 읽고 개인적으로 정리한 내용입니다. 내용에 오류가 있을 시 지적해주시면 감사하겠습니다.



# 11장 모든 악의 근원



> * $5 + 10CHF = $10(환율이 2:1일 경우)
> * ~~$5 * 2 = $10~~
> * ~~amount를 private으로 만들기~~
> * ~~Dollar 부작용?~~
> * Money 반올림?
> * ~~equals()~~
> * hashCode()
> * Equal null
> * Equal object
> * ~~5CHF * 2 = 10CHF~~
> * **Dollar/Franc 중복**
> * ~~공용 Equals~~
> * ~~공용 times~~
> * ~~Franc와 Dollar 비교하기~~
> * ~~통화?~~
> * testFrancMultiplication 제거



#

이제 Dollar와 Franc은 생성자밖에 남지 않았다. 생성자까지 모두 제거하여 하위 클래스를 제거하자.

#



```java
// Money 코드
static Money franc(int amount) {
  return new Money(amount, "CHF"); // 원래는 Franc
}

static Money dollar(int amount) {
  return new Money(amount, "USD"); // 원래는 Dollar
}
```

 

#

Dollar는 이제 어느 코드에서도 사용되지 않지만, Franc에 대한 참조는 테스트코드에 아직 남아있다.

#



``` java
public void testDifferentClassEquality() {
  assertTrue(new Money(10, "CHF").equals(new Franc(10, "CHF")));
}
```



#

`testEquality()` 동치성 테스트에서 이미 충분히 테스트하고있으므로, 위의 코드를 제거하자. 추가로, testEquality 내의 중복 코드도 제거하자.

#



```java
public void testEqaulity() {
  assertTrue(Money.dollar(5).equals(Money.dollar(5)));
  assertFalse(Money.dollar(5).equals(Money.dollar(6)));
	// assertTrue(Money.franc(5).equals(Money.franc(5))); 1번째 줄과 겹치므로 삭제
  // assertFalse(Money.franc(5).equals(Money.franc(6))); 2번째 줄과 겹치므로 삭제
  assertFalse(Money.franc(5).equals(Money.dollar(5)));
}
```



#

이전 장에서 다루었던 currency 비교의 경우, 여러 클래스가 존재할 때만 의미가 있다. 애초에 클래스가 다른 것들끼리 currency 개념으로 동일하게 비교하려고 만든 것이기 때문이다. 그러나 이제는 하위 클래스를 제거하려 하므로, Franc 클래스와 Money 클래스의 currency를 비교하고 클래스가 달라도 잘 작동하는지 테스트하는 `testDifferentClassEquality()` 테스트는 필요가 없다.



마찬가지로, 달러와 프랑 각각에 대한 테스트 코드는 이제 Money에 대한 테스트 코드 하나로 통합될 수 있다. 굳이 따로 둘 필요가 없는것이다.



#



> * $5 + 10CHF = $10(환율이 2:1일 경우)
> * ~~$5 * 2 = $10~~
> * ~~amount를 private으로 만들기~~
> * ~~Dollar 부작용?~~
> * Money 반올림?
> * ~~equals()~~
> * hashCode()
> * Equal null
> * Equal object
> * ~~5CHF * 2 = 10CHF~~
> * ~~Dollar/Franc 중복~~
> * ~~공용 Equals~~
> * ~~공용 times~~
> * ~~Franc와 Dollar 비교하기~~
> * ~~통화?~~
> * testFrancMultiplication 제거

